<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üé∞ Kosta-Roulette ‚Äî Kostas' 32nd</title>
  <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg1:#0a0a0a;--bg2:#1a0a2e;
      --neon-pink:#ff00ff;--neon-cyan:#00ffff;--neon-lime:#00ff88;--neon-yellow:#ffff00;
      --muted:#ffffff88;
    }
    *{margin:0;padding:0;box-sizing:border-box}
    body{
      font-family:'Poppins',sans-serif;
      background:radial-gradient(1200px 800px at 50% -10%, rgba(255,0,255,0.07), transparent 60%) , linear-gradient(135deg,var(--bg1),var(--bg2));
      color:#fff;min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;overflow-x:hidden;position:relative
    }
    .particle{position:absolute;border-radius:50%;pointer-events:none;background:radial-gradient(circle,rgba(255,255,255,.8) 0%,transparent 70%);animation:float 6s infinite ease-in-out}
    @keyframes float{0%,100%{transform:translateY(0) translateX(0);opacity:.3}50%{transform:translateY(-100px) translateX(50px);opacity:.8}}
    .wrap{width:100%;max-width:720px;padding:1.25rem 1rem 2rem;z-index:1}
    header{text-align:center;margin:1rem 0 .5rem}
    .title{
      font-family:'Bebas Neue',sans-serif;
      font-size:clamp(2rem,7vw,3.75rem);
      background:linear-gradient(90deg,var(--neon-pink),var(--neon-cyan),var(--neon-pink));
      background-size:200% auto;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;
      animation:gradient-shift 3s linear infinite;text-shadow:0 0 30px rgba(255,0,255,.45)
    }
    @keyframes gradient-shift{0%{background-position:0% 50%}100%{background-position:200% 50%}}
    .subtitle{color:var(--neon-lime);letter-spacing:2px;text-transform:uppercase;font-size:.95rem;text-shadow:0 0 16px rgba(0,255,136,.6)}
    .stage{margin:1.25rem auto 0;display:flex;flex-direction:column;gap:1rem;align-items:center;justify-content:center}
    .wheel-box{position:relative;display:grid;place-items:center}
    canvas{
      width:min(88vw,520px);height:min(88vw,520px);
      filter:drop-shadow(0 0 24px rgba(255,0,255,.25)) drop-shadow(0 0 24px rgba(0,255,255,.15));
      border-radius:50%;
    }
    .pointer{position:absolute;top:-8px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:24px solid var(--neon-yellow);filter:drop-shadow(0 0 10px rgba(255,255,0,.8))}
    .controls{display:flex;gap:.75rem;flex-wrap:wrap;align-items:center;justify-content:center;margin-top:.25rem}
    .btn{
      background:linear-gradient(135deg,rgba(255,0,255,.18),rgba(0,255,255,.18));
      border:2px solid var(--neon-cyan);border-radius:14px;padding:.85rem 1.2rem;color:#fff;font-weight:700;letter-spacing:.5px;
      cursor:pointer;transition:transform .2s ease, box-shadow .2s ease;user-select:none
    }
    .btn.spin{border-color:var(--neon-lime);box-shadow:0 0 18px rgba(0,255,136,.45)}
    .btn.reset{border-color:var(--neon-pink);box-shadow:0 0 18px rgba(255,0,255,.4)}
    .btn:active{transform:translateY(2px)}
    .btn:hover{box-shadow:0 0 36px rgba(0,255,255,.35)}
    .result{min-height:3.2rem;margin-top:.9rem;text-align:center;line-height:1.3}
    .result h2{font-size:clamp(1.15rem,4.3vw,1.8rem);font-weight:700}
    .result p{color:var(--muted);margin-top:.2rem}
    .footer{margin-top:1rem;text-align:center;color:#ffffff66;font-size:.9rem}
    .footer a{color:#ffffff88;text-decoration:none}.footer a:hover{color:#fff;text-decoration:underline}
    .confetti{position:absolute;width:10px;height:10px;background:var(--neon-pink);animation:confetti-fall 3s linear forwards;opacity:0;z-index:10;pointer-events:none}
    @keyframes confetti-fall{0%{opacity:1;transform:translateY(0) rotate(0)}100%{opacity:0;transform:translateY(100vh) rotate(720deg)}}
    @media (prefers-reduced-motion:reduce){.particle,.title,.confetti{animation:none}.btn{transition:none}}
  </style>
</head>
<body>
  <!-- background particles -->
  <div id="particles"></div>

  <div class="wrap">
    <header>
      <h1 class="title">üé∞ Kosta-Roulette</h1>
      <p class="subtitle">Spin the wheel of party dares</p>
    </header>

    <section class="stage">
      <div class="wheel-box">
        <div class="pointer" aria-hidden="true"></div>
        <canvas id="wheel" width="640" height="640" aria-label="Roulette wheel canvas"></canvas>
      </div>

      <div class="controls">
        <button class="btn spin" id="spinBtn">SPIN üé°</button>
        <button class="btn reset" id="resetBtn">Reset üîÅ</button>
      </div>

      <div class="result" id="result" aria-live="polite"></div>

      <div class="footer">Made with ‚ù§Ô∏è for Kostas & Friends ‚Äî Thessaloniki 2025 ‚Ä¢ <a href="index.html">Back home</a></div>
    </section>
  </div>

  <script>
    // Background particles
    (function createParticles(){
      const container=document.getElementById('particles');
      const n=18;
      for(let i=0;i<n;i++){
        const p=document.createElement('div');
        p.className='particle';
        const size=Math.random()*4+2;
        p.style.width=`${size}px`;p.style.height=`${size}px`;
        p.style.left=`${Math.random()*100}%`;p.style.top=`${Math.random()*100}%`;
        p.style.animationDelay=`${Math.random()*6}s`;
        p.style.animationDuration=`${Math.random()*4+4}s`;
        container.appendChild(p);
      }
    })();

    // Slimmer, punchier set: 8 slices
    const challenges = [
      'Shot with someone new üç∏',
      'Toast to Kostas ü•Ç',
      'Sing a love line üé§',
      'Teach a Greek phrase üá¨üá∑',
      '10-sec dance battle ü™©',
      'Wild 5-sec story ü§Ø',
      'Best DJ drop üìÄ',
      'Make a heart with hands üíñ'
    ];

    const sliceColors = ['#7c3aed','#14b8a6','#ec4899','#22c55e','#06b6d4','#f59e0b','#10b981','#0ea5e9'];

    const canvas = document.getElementById('wheel');
    const ctx = canvas.getContext('2d');

    // Retina scale
    function scaleCanvas(){
      const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
      const css = canvas.getBoundingClientRect();
      canvas.width = Math.round(css.width * dpr);
      canvas.height = Math.round(css.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);
    }
    scaleCanvas();

    let rotation = 0; // radians
    function dims(){
      return {
        w: canvas.clientWidth, h: canvas.clientHeight,
        cx: canvas.clientWidth/2, cy: canvas.clientHeight/2,
        r: Math.min(canvas.clientWidth, canvas.clientHeight)/2 - 6
      };
    }

    function drawWheel(){
      const {cx, cy, r} = dims();
      const n = challenges.length, arc = (Math.PI*2)/n;
      ctx.clearRect(0,0,canvas.clientWidth, canvas.clientHeight);

      for(let i=0;i<n;i++){
        const start = rotation + i*arc - Math.PI/2;
        const end   = start + arc;

        // slice
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.arc(cx, cy, r, start, end);
        ctx.closePath();
        ctx.fillStyle = sliceColors[i % sliceColors.length];
        ctx.fill();

        // separator
        ctx.strokeStyle = 'rgba(0,0,0,0.35)';
        ctx.lineWidth = 2; ctx.stroke();

        // text (smaller + outlined for readability)
        const mid = (start + end)/2;
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(mid);

        // text baseline near rim
        ctx.textAlign = 'right';
        ctx.font = '700 13px Poppins, sans-serif';        // << smaller
        const maxWidth = r - 18;                           // tighter padding
        const lineH = 15;
        const lines = wordWrapLines(ctx, challenges[i], maxWidth, 2);

        // outline for contrast then fill
        ctx.lineWidth = 4;
        ctx.strokeStyle = 'rgba(0,0,0,0.45)';
        ctx.fillStyle = '#fff';

        const startY = -((lines.length-1)*lineH)/2;
        for(let li=0; li<lines.length; li++){
          const y = startY + li*lineH;
          ctx.strokeText(lines[li], r - 8, y);
          ctx.fillText(lines[li],   r - 8, y);
        }
        ctx.restore();
      }

      // hub
      ctx.beginPath(); ctx.arc(cx, cy, 30, 0, Math.PI*2);
      ctx.fillStyle = '#111827'; ctx.fill();
      ctx.lineWidth = 3; ctx.strokeStyle = '#00ffff88'; ctx.stroke();

      ctx.beginPath(); ctx.arc(cx, cy, 44, 0, Math.PI*2);
      ctx.lineWidth = 2; ctx.strokeStyle = '#ff00ff66'; ctx.stroke();
    }

    function wordWrapLines(context, text, maxWidth, maxLines){
      const words = text.split(' ');
      const out = [];
      let line = '';
      for(let i=0;i<words.length;i++){
        const test = (line ? line+' ' : '') + words[i];
        if(context.measureText(test).width > maxWidth && line){
          out.push(line);
          line = words[i];
          if(out.length >= maxLines-1){ break; }
        }else{
          line = test;
        }
      }
      out.push(line);
      return out.slice(0, maxLines);
    }

    drawWheel();

    // Spin logic
    const spinBtn = document.getElementById('spinBtn');
    const resetBtn = document.getElementById('resetBtn');
    const resultBox = document.getElementById('result');
    let spinning = false;

    function spin(){
      if(spinning) return;
      spinning = true;
      resultBox.innerHTML = '';

      const n = challenges.length;
      const arc = (Math.PI*2)/n;
      const index = Math.floor(Math.random()*n);

      const sliceCenter = index*arc + arc/2;
      const pointerAngle = Math.PI*1.5;  // top
      const current = ((rotation % (Math.PI*2)) + Math.PI*2) % (Math.PI*2);
      const needed = (pointerAngle - sliceCenter);
      let delta = ((needed - current) % (Math.PI*2) + Math.PI*2) % (Math.PI*2);

      const fullSpins = 6;
      const jitter = (Math.random()-0.5) * (arc/1.8);
      const totalRotation = fullSpins*(Math.PI*2) + delta + jitter;

      const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const duration = prefersReduced ? 220 : 3400;
      const startRot = rotation;
      const t0 = performance.now();

      const easeOutCubic = t => 1 - Math.pow(1-t,3);

      function frame(now){
        const t = Math.min(1, (now - t0)/duration);
        rotation = startRot + totalRotation*easeOutCubic(t);
        drawWheel();
        if(t < 1){ requestAnimationFrame(frame); }
        else{
          spinning = false;
          const win = challenges[index];
          showResult(win);
          confettiBurst();
        }
      }
      requestAnimationFrame(frame);
    }

    function reset(){
      if(spinning) return;
      rotation = 0;
      drawWheel();
      resultBox.innerHTML = '';
    }

    spinBtn.addEventListener('click', spin);
    resetBtn.addEventListener('click', reset);
    spinBtn.addEventListener('keydown', (e)=>{ if(e.key===' '||e.key==='Enter'){ e.preventDefault(); spin(); } });

    // Result + confetti
    function showResult(text){
      resultBox.innerHTML = `<h2>üéâ ${escapeHTML(text)}</h2><p>Hit <strong>SPIN</strong> to play again!</p>`;
    }
    function confettiBurst(){
      const colors=['#ff00ff','#00ffff','#00ff88','#ffff00','#f43f5e','#a855f7'];
      const count=60;
      for(let i=0;i<count;i++){
        const c=document.createElement('div');
        c.className='confetti';
        c.style.left=`${Math.random()*100}%`;
        c.style.top='0';
        c.style.background=colors[Math.floor(Math.random()*colors.length)];
        c.style.animationDelay=`${Math.random()*0.5}s`;
        c.style.transform=`translateY(0) rotate(${Math.random()*360}deg)`;
        document.body.appendChild(c);
        setTimeout(()=>c.remove(),3200);
      }
    }
    function escapeHTML(str){return str.replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]))}

    // Handle resize for crisp canvas
    window.addEventListener('resize', ()=>{ scaleCanvas(); drawWheel(); });
  </script>
</body>
</html>